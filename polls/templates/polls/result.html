{% extends "polls/ticket_base.html" %}
{% block title %}Результаты голосования{% endblock %}
{% block script %}
<style>
  a {
  font: bold 17px Arial;
  text-decoration: none;
  background-color: #EEEEEE;
  color: #333333;
  padding: 2px 6px 2px 6px;
  border-top: 1px solid #CCCCCC;
  border-right: 1px solid #333333;
  border-bottom: 1px solid #333333;
  border-left: 1px solid #CCCCCC;
  display: block;
  margin: 0 auto;
  text-align: center;
}
</style>
{% endblock %}
{% block body %}
<article class="ticket">
  <header class="ticket__wrapper">
  </header>
    <header class="ticket__wrapper">
    <div class="ticket__header">
      <div class="ticket__title">
        Результаты голосования:
      </div>
    </div>
  </header>

  <div class="ticket__divider">
    <div class="ticket__notch"></div>
    <div class="ticket__notch ticket__notch--right"></div>
  </div>
  <div class="ticket__body">
    <section class="ticket__section">
        <p><b>{{ poll.title }}</b></p>
        <p><i>{{ poll.text }}</i></p>
    </section>
    <section class="ticket__section">
        <p><b>Результаты:</b></p>
        <ul>
            <li>Всего членов совета: {{ voters_count }}</li>
            <li>Присутствовало на заседании: {{ attended_count }}</li>
            <li>Роздано бюллетеней: {{ bulletins_visited }}</li>
            <li>Осталось нерозданных: {{ voters_count - bulletins_visited }}</li>
            <li>Оказалось в урне: {{ voted_count }}</li>
            <li style="margin-top: 1em;">За присуждение степени: {{ votes[Key.Response.YES]|length }}</li>
            <li>Против присуждение степени: {{ votes[Key.Response.NO]|length }}</li>
            {% if poll.allow_spoiling %}
            <li>Недействительных бюллетеней: {{ votes[Key.Response.SPOILED]|length }}</li>
            {% endif %}
        </ul>
        <p></p>
      </section>
      <p><a href="../..">Назад</a></p>
    <section class="ticket__section">
        <p><b>Подробно:</b></p>
        <ul>
            {% for response in Key.Response %}
            <b>{{ response.label }}</b>
            <ul>
                {% for key in votes.get(response, ()) %}
                <li>{{ key.value }}</li>
                {% endfor %}
            </ul>
            {% endfor %}
        </ul>
    </section>
    <section class="ticket__section">
        <p><b>Попыток голосовать с некорректным номером бюллетеня: {{ bad_key_count }}</b></p>
        <ul>
            {% for key in bad_keys_top_100 %}
            <li>{{ key.value }} в {{ key.timestamp.replace(microsecond=0) | localtime }}</li>
            {% endfor %}
        <ul>
    </section>
    </div>
  <footer class="ticket__footer">
    <svg width="70%" height="100%" version="1.1" viewBox="0 0 101.3 24.79" xmlns="http://www.w3.org/2000/svg">
      <g transform="translate(-17.5 -109.1)">
       <path d="m115.7 120.6-8.603 8.944-0.0643-19.81-2.486-0.4728-6.395 17.07-0.05385-16.59-2.087-0.6143-9.545 15.6-0.03398-10.51-1.766-0.6898-10.84 12.42-0.03803-11.73-1.577-0.6157-11.03 12.63-0.03902-12.02-1.387-0.5419-11.22 12.85-0.03996-12.31-1.272-0.3666-9.958 16.68-0.06757-20.78-1.052-0.1846-7.024 20.45-0.06564-20.26-0.673-0.2682-10.92 12.18 1.112 0.2238 9.702-11.13-0.07143 22 0.8983 0.1575 7-19.95-0.06429 19.8 1.142 0.329 9.932-16.39-0.03823 11.78 1.279 0.4996 11.19-12.65-0.03939 12.15 1.468 0.5734 11-12.43-0.03842 11.86 1.657 0.6475 10.81-12.22-0.03743 11.57 1.955 0.5753 9.509-15.31-0.06235 19.2 2.33 0.4431 6.345-16.6-0.0523 16.16 2.33 0.9765 8.029-8.238 4.004-4.107z" fill="#231f20"/>
      </g>
     </svg>
  </footer>
</article>
{% endblock %}